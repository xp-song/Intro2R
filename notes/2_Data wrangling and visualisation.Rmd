---
title: "Data Wrangling and Visualisation"
subtitle: "[Intro2R](https://github.com/xp-song/Intro2R) crash course: Session 2 of 2"
author: "author: xpsong"
date: "updated: `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: true
    theme: paper
---

```{r load_packages, echo = FALSE, message = FALSE, warning = FALSE}
#commands are separated by ; or a new line
library(dplyr); library(tidyr) #data manipulation
library(ggplot2) #data visualisation 
library(knitr) #to knit HMTL
```

---

# Header

```{r eval = FALSE}
data() #built-in datasets in R
data(package="ggplot2")

#library(ggplot2)
diamonds <- data(diamonds, package = "ggplot2")
```

```{r eval = FALSE}
#R automatically creates index column
#ozone <- ozone[ , !names(ozone) %in% "X"] #you can remove this index column


NAs in Dataframes:
Option 1:
na.omit(datafilename): remove ALL rows with NAs #But may remove valuable info!

Option 2:
- Check VARIABLES with high proportion of NA first using use apply(X, MARGIN, FUN, ...)+
apply(apply(CO2,2,is.na),2,sum): indicates how many NAs in EACH column (a NESTED apply function)
#For margin argument, "1" indicates rows while "2" indicates columns, while c(1,2) indicates both - this specifies the grouping.

- Remove NAs individually
nonNAvalues <- complete.cases(dataframename): create a logical vector
dataframename[nonNAvalues,]: Subset & see only non-NA values
is.na()



SUBSCRIPTS (SUBSETTING) AND INDICES
Subsetting:
[]: returns object of SAME CLASS as original
[[]]: extract elements of list/dataframe, only used to extract single element, class of object will not necessarily be the same #similar to $


e.g. Viewing only data for Mississippi+
CO2[CO2$Type == "Mississippi",]

e.g. Viewing only ROWS for which "uptake" is greater than the mean and "conc" is greater than 200+
CO2[CO2$uptake>mean(CO2$uptake) & CO2$conc>200,]

  
  
OTHER DATA MANIPULATION IN DATAFRAMES

unique(dataframeA): Remove DUPLICATE rows

scale(x, center=TRUE, scale=TRUE): centers & scales the data (deducts the mean per column, divides by standard deviation)

```


# Data cleaning

1) Save your .xlsx file as a csv (comma delimited) in the /raw folder and give it a name (eg. responses_YYYYMMDD.csv)

2) Load it into R

```{r message = FALSE, warning = FALSE}
#svy.df <- read.csv("raw/responses_20190311.csv", stringsAsFactors = FALSE, check.names=FALSE) 
#import the data as 'svy.df'
#the location of .Rproj file is where the working directory is (so, no need to type the entire file path)
```



```{r other tests, eval = FALSE}
#other tests u may consider

#require(stats)
t.test()


#other useful packages::functions to consider for surveys
library(survey)
svydesign() #specify survey design
survey::postStratify() #adjusts sampling weights so that the joint distribution of a set of post-stratifying variables matches the known population joint distribution. 

library(likert)

```







