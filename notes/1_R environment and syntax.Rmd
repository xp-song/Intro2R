---
title: "R Environment and Syntax"
subtitle: "[Intro2R](https://github.com/xp-song/Intro2R): Lesson 1 of 4"
author: "author: xpsong"
date: "updated: `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: false
    theme: paper
---

```{r load_packages, echo = FALSE, message = FALSE, warning = FALSE}
#commands are separated by ; or a new line
library(dplyr); library(tidyr) #data manipulation
library(ggplot2) #data visualisation 
library(knitr) #to knit HMTL
```

---

# Objects in R

## Variables
- Used to store data
- Naming should be consistent/clear
  - Case sensitive, no numbers/symbols/whitespace
  - E.g. treeHeight_m, species_count
- **Data types:** Numeric, integer, character, logical (T/F) or complex
```{r variables, eval = FALSE}
#numeric data
x <- 4
x <- (4+5)/2

#character data
x <- "hello"
```
## Data Structures
### Vectors 
- Sequential collection of data of the _same_ type
- Coercion occurs if different types are mixed
- Asking and coercion can be done manually to change the vector (data) type
```{r eval = FALSE}
#numeric vectors
x <- c(1,3,5,6) 
x <- 1:5
x <- seq(1,5,1)
x <- vector("numeric", length=10)
num_vec <- c(TRUE, 2) #in R, TRUE=1, FALSE=0
is.numeric(num_vec) 

#character vectors
x <- c("hello", "a", "b", "c")
x <- c(1.7, "a")
char_vec <- c("a", TRUE) #'TRUE' turned from logical to character
is.character(char_vec) 

x <- as.character(num_vec) #coercion from numeric to character
x
```
### Lists
- Consist of different elements (i.e. variables/vectors) that can be of _different types_
- Elements in a list are indexed with [[]], individual items are in []
- Functions only be applied to vectors, not lists!
```{r eval= FALSE}
mylist <- list(num_vec, char_vec, 1.783, 5L, "hello") #add L suffix if you explicitly want integers
mylist
is.list(mylist) #asking
```

### Factors

- Used to represent data with limited, discrete categories (i.e. categorical, ordinal, or even binary)
- Can be coded as character or numeric
- Some examples:
  - Tom, Dick, Harry
  - Blue, Black, Brown (eye color)
  - High, Medium, Low (3, 2, 1)
  - Strongly disagree, disagree, neutral, agree, strongly agree (-2:2)
  - Male, Female (1, 2)

```{r, eval = FALSE}
x <- factor(c("SA", "D", "A", "A", "SA", "Neutral", "SD"))
x

#define order (default is alphabetical)
x <- factor(c("SA", "D", "A", "A", "SA", "Neutral", "SD"), levels = c("SD", "D", "Neutral", "A", "SA"))
x

unclass(x) #show as numbers, with "levels" attribute showing actual text
```

### Matrices
- Data in rectangular format (2D array with rows & columns)
- Data must be of the _same_ type!
- More memory efficient than dataframes
```{r eval = FALSE}
m <- matrix(1:12, nrow = 4)
m #data goes in by columns in default mode

dim(m) #dimensions: no. of rows & cols 
dimnames(m)
dimnames(m) <- list(c("Tom", "Dick", "Harry", "Me"), c("Blue", "White", "Red")) #add names to row/cols

#size comparisons
object.size(m) # 264 bytes
d <- as.data.frame(m) #convert to dataframe
object.size(d) # 1032 bytes
```

### Dataframes
- Data in rectangular format (2D array with rows & columns)
- Columns can contain _different_ types of data variables (i.e. numeric, character, etc.)
- Each column are vectors/lists of similar length
```{r eval = FALSE}


dim(df) #dimensions: no. of rows & cols 
dimnames(df) #works?

head(df) #view first few rows only
names(df)

is.na()


data(): See all built-in datasets in R packages
data(datafilename): see specific data (e.g. data(CO2))
data(package="packagename"): check datasets in other packages
#subsetting
x[3,2]
x[1:3, c(1,3)]
x[3,]

```




## Functions

- Try looking up functions: `?library`

read.table
read.csv() #Default Header=T




# Data cleaning

1) Save your .xlsx file as a csv (comma delimited) in the /raw folder and give it a name (eg. responses_YYYYMMDD.csv)

2) Load it into R

```{r message = FALSE, warning = FALSE}
#svy.df <- read.csv("raw/responses_20190311.csv", stringsAsFactors = FALSE, check.names=FALSE) 
#import the data as 'svy.df'
#the location of .Rproj file is where the working directory is (so, no need to type the entire file path)
```



```{r other tests, eval = FALSE}
#other tests u may consider

#require(stats)
t.test()


#other useful packages::functions to consider for surveys
library(survey)
svydesign() #specify survey design
survey::postStratify() #adjusts sampling weights so that the joint distribution of a set of post-stratifying variables matches the known population joint distribution. 

library(likert)

```


